using OpenQA.Selenium.Chrome;
using OpenQA.Selenium;
using System;
using System.Linq;

namespace SeleniumTest
{
    internal class SeleniumFormElements
    {
        public static void Main()
        {
            // Initialize the ChromeDriver
            IWebDriver driver = new ChromeDriver();
            
            try
            {
                // Navigate to Sauce Demo
                driver.Navigate().GoToUrl("https://www.saucedemo.com/");
                driver.Manage().Window.Maximize();
                
                // Enter username and password
                IWebElement usernameField = driver.FindElement(By.Id("user-name"));
                IWebElement passwordField = driver.FindElement(By.Id("password"));
                IWebElement loginButton = driver.FindElement(By.Id("login-button"));

                usernameField.SendKeys("standard_user");
                passwordField.SendKeys("secret_sauce");
                loginButton.Click();
                
                // Wait for page to load
                driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(5);

                // Click the first product's "Add to cart" button
                IWebElement addToCartButton = driver.FindElement(By.CssSelector(".btn_primary"));
                addToCartButton.Click();
                
                // Go to the cart
                IWebElement cartButton = driver.FindElement(By.ClassName("shopping_cart_link"));
                cartButton.Click();
                
                // Proceed to checkout
                IWebElement checkoutButton = driver.FindElement(By.Id("checkout"));
                checkoutButton.Click();
                
                // Fill out checkout information
                IWebElement firstNameField = driver.FindElement(By.Id("first-name"));
                IWebElement lastNameField = driver.FindElement(By.Id("last-name"));
                IWebElement postalCodeField = driver.FindElement(By.Id("postal-code"));
                IWebElement continueButton = driver.FindElement(By.Id("continue"));
                
                firstNameField.SendKeys("John");
                lastNameField.SendKeys("Doe");
                postalCodeField.SendKeys("12345");
                continueButton.Click();
                
                // Finalize the order
                IWebElement finishButton = driver.FindElement(By.Id("finish"));
                finishButton.Click();
                
                // Verify "Thank you for your order" message
                IWebElement thankYouMessage = driver.FindElement(By.ClassName("complete-header"));
                string messageText = thankYouMessage.Text;

                // Print the message to console
                Console.WriteLine("========Order Confirmation Message=========");
                Console.WriteLine(messageText);
                Console.WriteLine("==============END==========================");
            }
            catch (NoSuchElementException ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
            }
            finally
            {
                // Close the browser
                driver.Quit();
            }
        }
    }
}
